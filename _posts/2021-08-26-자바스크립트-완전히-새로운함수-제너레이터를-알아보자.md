---
title: 자바스크립트의 새로운 함수 Generator를 알아보자
date: 2021-08-26 23:18:01
permalink: /:short_year-:month-:day/:title
categories: [frontend, web/network]
tags: [javascript, generator, ES6]
---

# 자바스크립트의 새로운 함수 Generator를 알아보자
## Generator는?

순차적으로 진행하는 자바스크립트의 특별한 함수.



## 사용법

### 1. 선언

function을 선언할 때 에 `*` 을 추가한다.

```javascript
// Recommend
function* example() {}

// Not Recommend
function *example() {}
```

- function과 함수 이름중에서 function에 `*`을 붙여주는 것을 추천한다.



### 2. yeild와 next() 메소드

제너레이터는 yield를 순차적으로 실행하는데, 이를 실행하기 위해서는 next() 메소드를 활용해야 다음 yield로 넘어갈 수 있다.

```javascript
function* f1() {
    console.log('f1-1');
    yield 10;
    console.log('f1-2');
    yield 20;
    console.log('f1-3');
    return 'finished'
}

const gen = f1();		//(1)
console.log(gen.next());//(2)
console.log(gen.next());//(3)
console.log(gen.next());//(4)
```

- (1)까지는 아무것도 출력되지 않는다.
- (2)가 실행되면 로그에 f1-1이 출력되고 {value: 10, done: false}가 반환된다. next의 반환값은 항상 value와 done이 포함된 객체로 넘어온다. done은 이 제너레이터 함수가 모두 실행되면 true가 된다.
- (3)이 실행되면 로그에 f1-2이 출력되고 {value: 20, done: false}가 반환된다.
- (3)이 실행되면 로그에 f1-3이 출력되고 {value: 'finished', done: true}가 반환된다.



:heavy_exclamation_mark: **만약 return 다음에 yield가 더 있다하더라도 return이 된 순간 더 이상 next() 메소드는 동작하지 않고 이후 yield는 모두} {value: undefined, done: true} 만이 반환된다.**



## 3. Generator를 쓰는 이유, 장점

### :bulb: Generator는 실행되는 딱 그 순간에만 연산을 실행한다. 따라서 무의미한 반복이 필요하지 않다.

>  마치 배열에서 순회하는 것과 같이 작동하는데, 배열의 경우 처음 생성할 때부터 모든 값이 정해져있기 때문에 메모리 사용량이 많다. 하지만 제너레이터는 만들어지는 그 때 메모리에 저장되기 때문에 <u>메모리 활용성 측면에서 큰 장점</u>이 있다.

- 예) 배열의 끝까지 다 순회하지 않고 필요한 곳까지만 순회하는 사례

  ```javascript
  const values = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
  const result = take(3,
  map(filter(values, n=> n % 2 === 0),
      n => n* 10
  	)
  )
  ```

- 위의 예시는 과연 어떤 값을 반환할까?

- log를 찍어보면 [20, 40, 60]이 반환될 것이다.

- 짝수를 순회하다가 `take(3)`를 보고 3번째에서 딱 멈추는 것이다. Generator의 효율성이 돋보인다.



### :bulb: 메모리 사용이 효율적으로 사용할 수 있다.

- 예) map, filter함수 등을 반환하는 배열 없이 만들어서 쓸 수 있다.

  ```javascript
  function* map(iter, mapper) {
      for (const v of iter) {
          yield mapper(v);
      }
  }
  
  function* filter(iter, test) {
      for (const v of iter) {
          if (test(v)) {
              yield v;
          }
      }
  }
  
  ```

- 위와 같이 map, filter함수를 제너레이터로 만들어서 사용하면 기존 내장함수보다 메모리를 더 효율적으로 사용할 수 있다.



---

Ref.

실전 자바스크립트 - 이재승

